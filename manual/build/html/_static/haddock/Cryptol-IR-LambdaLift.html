<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cryptol.IR.LambdaLift</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cryptol-compiler-0.1.0.0</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cryptol.IR.LambdaLift</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Lift local functions to the top level.
  1. Free local variables become parameters
  2. Any type variables that are mentioned become type parameters
  3. Any constraints that mention these variables.
  3.5 Note that if these constraints mention variables that are not mentioned
      anywhere else we need to also add *them*, which in turn might add more
      constraints, etc.
  4. Each use of the local function needs to pass these additional
     parameters.
  5. Note that locally defined functions (i.e., non-parameter ones)
     do not become paramters because they will be lifter.</p><p>In summary, given: `e where ds` and the <code>ds</code> are in dependency order.
  For each <code>d</code> in order:
    * rewrite definition to eliminte any functions that were already lifted.
    * compute free variables (types, values, predicates)
    * using this add a new top-level declaration.
    * remember how to change the instantiations, in the continuation
  Once we've done all the <code>ds</code> we need to rewrite the <code>e</code></p><p>f <code>ts </code>ps xs  ~&gt;   f <code>(freeTs++ts) </code>(newPs ++ ps) (freeVars ++ xs)</p><p>In a smillar way we also need to lift lambdas, except that they are only
goind to be used in place.</p><p>When we are a lifting a polymorphic local, we should make sure to not
add constraints that the function already has, so in the above example,
the (++) in the constratins is a bit more complicated.
Similarly, in the definition of the lifted function we have to insert the
correct number of PAbs.</p><dl><dt>Local Polymorphic Values</dt><dd>Note that we also lambda lift local polymorphic values, which hopefully
should not be very common as we have local mono binds on by default.</dd></dl></div></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:llModule" class="def">llModule</a> :: <a href="${pkgroot}/../../../share/doc/ghc-9.6.2/html/libraries/containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-ModuleSystem-Name.html#t:Name" title="Cryptol.ModuleSystem.Name">Name</a> <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-TypeCheck-Type.html#t:Schema" title="Cryptol.TypeCheck.Type">Schema</a> -&gt; <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-ModuleSystem-Name.html#t:Supply" title="Cryptol.ModuleSystem.Name">Supply</a> -&gt; <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-TypeCheck-AST.html#t:ModuleG" title="Cryptol.TypeCheck.AST">ModuleG</a> mname -&gt; ((<a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-TypeCheck-AST.html#t:ModuleG" title="Cryptol.TypeCheck.AST">ModuleG</a> mname, <a href="${pkgroot}/../../../share/doc/ghc-9.6.2/html/libraries/containers-0.6.7/Data-Map-Strict.html#t:Map" title="Data.Map.Strict">Map</a> <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-ModuleSystem-Name.html#t:Name" title="Cryptol.ModuleSystem.Name">Name</a> <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-TypeCheck-Type.html#t:Schema" title="Cryptol.TypeCheck.Type">Schema</a>), <a href="file:///home/diatchki/src/cryptol/compiler/dist-newstyle/build/x86_64-linux/ghc-9.6.2/cryptol-3.0.0.99/doc/html/cryptol/Cryptol-ModuleSystem-Name.html#t:Supply" title="Cryptol.ModuleSystem.Name">Supply</a>) <a href="#v:llModule" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.28.0</p></div></body></html>